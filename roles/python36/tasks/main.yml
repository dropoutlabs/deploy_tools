- apt:
    name: python3.5
    state: build-dep
    update_cache: yes

- file:
    path: /home/src
    state: directory

- get_url:
    url: https://www.python.org/ftp/python/3.6.2/Python-3.6.2.tgz
    dest: /home/src/

- unarchive:
    src: /home/src/Python-3.6.2.tgz
    dest: /home/src/
    remote_src: yes

- shell: |
    ./configure
    make
    make altinstall
  args:
    chdir: /home/src/Python-3.6.2
  register: out

- debug: var=out.stdout_lines

- pip:
    name: "{{ item }}"
    executable: pip3.6
  with_items:
    - virtualenvwrapper

- file:
    path: /home/venvs
    state: directory

- file:
    path: /home/ysz/src
    state: directory

- blockinfile:
    path: /home/vagrant/.bashrc
    block: |
      export WORKON_HOME=/home/venvs
      export PROJECT_HOME=/home/ysz/src
      export VIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python3.6
      source /usr/local/bin/virtualenvwrapper.sh      

- name: here
  file:
    path: /home/venvs
    owner: vagrant
    group: vagrant
    recurse: true
